<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'style.css' %}">
</head>
<body>
    <h2>Welcome, {{ request.user.username }} | <a href="{% url 'logout' %}">Logout</a></h2>

    <h3>Calculate Tax</h3>
    <form method="POST">
        {% csrf_token %}
        <input type="hidden" name="calculate_tax" value="1">

        <label>Income:</label><br>
        <input type="number" name="income" step="0.01" required><br><br>

        <label>Expenses:</label><br>
        <input type="number" name="expenses" step="0.01" required><br><br>

        <label>Deductions:</label><br>
        <input type="number" name="deductions" step="0.01" required><br><br>

        <button type="submit">Calculate</button>
    </form>

    <h3>Your Tax Entries</h3>
    <table border="1">
        <tr>
            <th>Income</th>
            <th>Expenses</th>
            <th>Deductions</th>
            <th>Calculated Tax</th>
            <th>Date</th>
        </tr>
        {% for entry in tax_entries %}
        <tr>
            <td>{{ entry.income }}</td>
            <td>{{ entry.expenses }}</td>
            <td>{{ entry.deductions }}</td>
            <td>{{ entry.calculated_tax }}</td>
            <td>{{ entry.created_at }}</td>
        </tr>
        {% empty %}
        <tr><td colspan="5">No entries yet.</td></tr>
        {% endfor %}
    </table>

    <h3>Upload Document</h3>
    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <input type="hidden" name="upload_file" value="1">

        <label>Description:</label><br>
        <input type="text" name="description"><br><br>

        <label>Select File:</label><br>
        <input type="file" name="document" required><br><br>

        <button type="submit">Upload</button>
    </form>

    <h3>Your Documents</h3>
    <ul>
        {% for doc in documents %}
            <li><a href="{{ doc.file.url }}" target="_blank">{{ doc.description|default:"No Description" }}</a> (Uploaded: {{ doc.uploaded_at }})</li>
        {% empty %}
            <li>No documents uploaded yet.</li>
        {% endfor %}
    </ul>
</body>
</html>